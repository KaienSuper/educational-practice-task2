<!DOCTYPE html>
<head>
	<title>2 задание</title>
	<link rel="stylesheet" href="style.css">
	<meta charset="UTF-8">
</head>
<body>
	<table width="100%" border="1" cellspacing="0" cellpadding="4">
		<caption>Таблица инструментов</caption>  
		<tr>
			<th>&nbsp;</th><th>1 столбец</th>
			<th>2 столбец</th><th>3 столбец</th>
		</tr>
		<tr>
			<td>1 ряд</td>
			<td><span class="dynamic"><img src="screwdriver.png"><img src="pilers.png"><img src="axe.png"><img src="hammer.png"></span></td>
			<td><span class="dynamic"><img src="pilers.png"><img src="axe.png"><img src="hammer.png"><img src="screwdriver.png"></span></td>
			<td><span class="dynamic"><img src="axe.png"><img src="pilers.png"><img src="screwdriver.png"><img src="hammer.png"></span></td>
		</tr>
		<tr>
			<td>2 ряд</td>
			<td><span class="dynamic"><img src="hammer.png"><img src="screwdriver.png"><img src="axe.png"><img src="pilers.png"></span></td>
			<td><span class="dynamic"><img src="pilers.png"><img src="hammer.png"><img src="axe.png"><img src="screwdriver.png"></span></td>
			<td><span class="dynamic"><img src="screwdriver.png"><img src="axe.png"><img src="pilers.png"><img src="hammer.png"></span></td>
		</tr>
		<tr>
			<td>3 ряд</td>
			<td><span class="dynamic"><img src="screwdriver.png"><img src="pilers.png"><img src="hammer.png"><img src="axe.png"></span></td>
			<td><span class="dynamic"><img src="screwdriver.png"><img src="hammer.png"><img src="axe.png"><img src="pilers.png"></span></td>
			<td><span class="dynamic"><img src="pilers.png"><img src="axe.png"><img src="hammer.png"><img src="screwdriver.png"></span></td>
		</tr>
	</table>
</body>

<script>

var elems = document.getElementsByClassName("dynamic"),
 trampInput = document.createElement("input");
 istdselect = false;
            trampInput.type = "text";
            trampInput.style.width = "128px";
            trampInput.addEventListener("blur", function() {
				let innerText = trampInput.value;
				innerText = innerText.replace( /О/gi, "<img src=\"screwdriver.png\">" );
				innerText = innerText.replace( /П/gi, "<img src=\"pilers.png\">" );
				innerText = innerText.replace( /М/gi, "<img src=\"hammer.png\">" );
				innerText = innerText.replace( /Т/gi, "<img src=\"axe.png\">" );				
				trampInput.parentNode.innerHTML = innerText;
				istdselect = false;	
			}
            , false);
for (var i=0; i<elems.length; i++) {
    var el = elems[i];
    el.addEventListener("click", function() {
        if (istdselect) return;
		istdselect = true;
		let innerText = this.innerHTML;
		innerText = innerText.replace( /<img src=\"screwdriver.png\">/gi, "О" );
		innerText = innerText.replace( /<img src=\"pilers.png\">/gi, "П" );
		innerText = innerText.replace( /<img src=\"hammer.png\">/gi, "М" );		
		innerText = innerText.replace( /<img src=\"axe.png\">/gi, "Т" );		
        trampInput.value = innerText;
        this.innerHTML = "";
        this.appendChild(trampInput);
        trampInput.focus();
        trampInput.select()
		}.bind(el), false);
	};
</script>
